<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Histórico de Leituras</title>
</head>
<body>
  <h2>Registro de Leitura de Energia</h2>

  <label>Data da leitura:</label>
  <input type="date" id="dataLeitura"><br><br>

  <label>Leitura anterior:</label>
  <input type="number" id="leituraAnterior"><br><br>

  <label>Leitura atual:</label>
  <input type="number" id="leituraAtual"><br><br>

  <button onclick="salvarLeitura()">Salvar leitura</button>

  <h3>Histórico de Leituras</h3>
  <table border="1">
    <thead>
      <tr>
        <th>Data</th>
        <th>Leitura anterior</th>
        <th>Leitura atual</th>
        <th>Consumo</th>
      </tr>
    </thead>
    <tbody id="tabelaHistorico"></tbody>
  </table>

  <script>
    function salvarLeitura() {
      const data = document.getElementById("dataLeitura").value;
      const anterior = document.getElementById("leituraAnterior").value;
      const atual = document.getElementById("leituraAtual").value;

      if (!data || !anterior || !atual) {
        alert("Preencha todos os campos!");
        return;
      }

      const historico = JSON.parse(localStorage.getItem("leituras")) || [];

      historico.push({
        data: data,
        leituraAnterior: Number(anterior),
        leituraAtual: Number(atual)
      });

      localStorage.setItem("leituras", JSON.stringify(historico));
      atualizarTabela();
    }

    function atualizarTabela() {
      const historico = JSON.parse(localStorage.getItem("leituras")) || [];
      const tabela = document.getElementById("tabelaHistorico");
      tabela.innerHTML = "";

      historico.forEach(item => {
        const linha = document.createElement("tr");
        linha.innerHTML = `
          <td>${formatarData(item.data)}</td>
          <td>${item.leituraAnterior}</td>
          <td>${item.leituraAtual}</td>
          <td>${item.leituraAtual - item.leituraAnterior}</td>
        `;
        tabela.appendChild(linha);
      });
    }

    function formatarData(dataISO) {
      const [ano, mes, dia] = dataISO.split("-");
      return `${dia}/${mes}/${ano}`;
    }

    // Atualiza a tabela ao abrir o site
    window.onload = atualizarTabela;
  </script>
</body>
</html>
